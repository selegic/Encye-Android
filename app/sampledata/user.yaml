# -----------------------------------------
# USER API ROUTES
# -----------------------------------------

/api/v1/user/sign-up:
  post:
    tags: [User]
    summary: Register a new user
    description: Create a new user account with email and password
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - firstName
              - lastName
              - email
              - password
            properties:
              firstName:
                type: string
                example: John
              lastName:
                type: string
                example: Doe
              email:
                type: string
                format: email
                example: john.doe@example.com
              password:
                type: string
                format: password
                example: SecurePass123!
              organization:
                type: string
                description: Organization ID (optional)
    responses:
      200:
        description: User created successfully
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ApiResponse"
      401:
        description: Sign up unsuccessful
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Error"


/api/v1/user/create-session:
  post:
    tags: [User]
    summary: User login
    description: Authenticate user with email and password
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - email
              - password
            properties:
              email:
                type: string
                format: email
                example: john.doe@example.com
              password:
                type: string
                format: password
                example: SecurePass123!
              isIosDevice:
                type: boolean
                description: Flag for iOS device login
    responses:
      200:
        description: Login successful
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: Sign In successful!
                data:
                  type: object
                  properties:
                    token:
                      type: string
                    expiresIn:
                      type: number
      422:
        description: Invalid credentials
      401:
        description: Account not activated


/api/v1/user/mobile-auth:
  post:
    tags: [User]
    summary: Mobile authentication
    description: Authenticate mobile users with extended token expiry
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - email
              - password
            properties:
              email:
                type: string
                format: email
              password:
                type: string
                format: password
    responses:
      200:
        description: Mobile authentication successful
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ApiResponse"


/api/v1/user/activate/{userId}:
  get:
    tags: [User]
    summary: Activate user account
    description: Activate user account via email confirmation link
    parameters:
      - in: path
        name: userId
        required: true
        schema:
          type: string
    responses:
      200:
        description: Account activated successfully
      404:
        description: Invalid activation link


/api/v1/user/user-details:
  get:
    tags: [User]
    summary: Get authenticated user details
    description: Retrieve detailed information about the currently authenticated user
    security:
      - bearerAuth: []
    responses:
      200:
        description: User details retrieved successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                msg:
                  type: string
                data:
                  $ref: "#/components/schemas/User"
                likedArticles:
                  type: array
                  items:
                    type: string
      401:
        $ref: "#/components/responses/UnauthorizedError"


/api/v1/user/auth/google:
  get:
    tags: [User]
    summary: Initiate Google OAuth
    description: Redirect to Google for OAuth authentication
    responses:
      302:
        description: Redirect to Google OAuth


/api/v1/user/auth/google/callback:
  get:
    tags: [User]
    summary: Google OAuth callback
    description: Handle Google OAuth callback and sign in user
    parameters:
      - in: query
        name: code
        schema:
          type: string
    responses:
      200:
        description: Successfully authenticated with Google
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                data:
                  type: object
                  properties:
                    token:
                      type: string
                    userId:
                      type: string
                    firstName:
                      type: string
                    lastName:
                      type: string
                    new:
                      type: boolean


/api/v1/user/login-history:
  get:
    tags: [User]
    summary: Get user login history
    description: Retrieve login history for the authenticated user
    security:
      - bearerAuth: []
    responses:
      200:
        description: Login history retrieved successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                message:
                  type: string
                data:
                  type: array
                  items:
                    type: object
                    properties:
                      userId:
                        type: string
                      userName:
                        type: string
                      email:
                        type: string
                      loginTime:
                        type: string
                        format: date-time
                      sourceIp:
                        type: string
                      location:
                        type: string
                      platform:
                        type: string
      401:
        $ref: "#/components/responses/UnauthorizedError"


/api/v1/user/all-login-history:
  get:
    tags: [User]
    summary: Get all users login history (Admin only)
    description: Retrieve login history for all users - requires admin or content creator role
    security:
      - bearerAuth: []
    responses:
      200:
        description: All login history retrieved successfully
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ApiResponse"
      401:
        $ref: "#/components/responses/UnauthorizedError"


/api/v1/user/update:
  put:
    tags: [User]
    summary: Update user details
    description: Update user profile information
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            properties:
              firstName:
                type: string
              lastName:
                type: string
              about:
                type: string
              role:
                type: string
                enum: [user, admin, content creator]
              extendedRole:
                type: string
                enum: [author]
              userId:
                type: string
              addPreferences:
                type: array
                items:
                  type: string
              removePreferences:
                type: array
                items:
                  type: string
              image:
                type: string
                format: binary
    responses:
      200:
        description: User updated successfully
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ApiResponse"
      401:
        $ref: "#/components/responses/UnauthorizedError"


/api/v1/user/all:
  get:
    tags: [User]
    summary: Get all users
    description: Retrieve a list of all registered users
    security:
      - bearerAuth: []
    responses:
      200:
        description: Users retrieved successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                msg:
                  type: string
                data:
                  type: array
                  items:
                    $ref: "#/components/schemas/User"
      401:
        $ref: "#/components/responses/UnauthorizedError"


/api/v1/user/profile/{id}:
  get:
    tags: [User]
    summary: Get user profile by ID
    description: Retrieve detailed profile information for a specific user including their articles and posts
    security:
      - bearerAuth: []
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: string
    responses:
      200:
        description: User profile retrieved successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                message:
                  type: string
                data:
                  type: object
                  properties:
                    user:
                      $ref: "#/components/schemas/User"
                    isFollowing:
                      type: boolean
                    articles:
                      type: array
                      items:
                        $ref: "#/components/schemas/Article"
                    posts:
                      type: array
                      items:
                        $ref: "#/components/schemas/Post"
      401:
        $ref: "#/components/responses/UnauthorizedError"


/api/v1/user/forgot-password:
  post:
    tags: [User]
    summary: Request password reset
    description: Send password reset email to user
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - email
            properties:
              email:
                type: string
                format: email
                example: john.doe@example.com
    responses:
      200:
        description: Password reset email sent
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: Reset password link has been sent to your email id!!
      404:
        description: Email not found


/api/v1/user/reset-password/{userId}:
  post:
    tags: [User]
    summary: Reset password
    description: Reset user password with token from email
    parameters:
      - in: path
        name: userId
        required: true
        schema:
          type: string
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - password
              - confirmPassword
            properties:
              password:
                type: string
                format: password
              confirmPassword:
                type: string
                format: password
    responses:
      200:
        description: Password reset successful
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: Password reset successfully, Please login!!
      404:
        description: User not found or token expired


/api/v1/user/follow:
  post:
    tags: [User]
    summary: Follow a user
    description: Follow another user
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - id
            properties:
              id:
                type: string
                description: User ID to follow
    responses:
      200:
        description: Follow created successfully
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ApiResponse"
      401:
        $ref: "#/components/responses/UnauthorizedError"


/api/v1/user/unfollow/{id}:
  delete:
    tags: [User]
    summary: Unfollow a user
    description: Stop following a user
    security:
      - bearerAuth: []
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: string
    responses:
      200:
        description: Unfollowed successfully
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ApiResponse"
      401:
        $ref: "#/components/responses/UnauthorizedError"


/api/v1/user/remove-follower/{id}:
  delete:
    tags: [User]
    summary: Remove a follower
    description: Remove a user from your followers list
    security:
      - bearerAuth: []
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: string
    responses:
      200:
        description: Follower removed successfully
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ApiResponse"
      401:
        $ref: "#/components/responses/UnauthorizedError"
